<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>{{ testResult.name }} Test Results</h3>
  <!-- Back to Patients Button -->
</div>

<table *ngIf="testResult && dates.length > 0" class="table table-bordered table-striped table-hover text-center mt-4">
  <thead class="thead-dark">
  <tr>
    <!-- Display the Date column only once -->
    <th class="text-center">Date</th>
    <!-- Iterate through test result keys (excluding Date) -->
    <th class="text-center" *ngFor="let param of parameterKeys">
      {{ param }}
    </th>
  </tr>
  </thead>
  <tbody>
  <!-- Iterate over the sorted unique dates -->
  <tr *ngFor="let date of dates">
    <!-- Show the Date only once per row -->
    <td class="text-center">{{ date }}</td>
    <!-- For each parameter, find the value for the specific date -->
    <td class="text-center" *ngFor="let param of parameterKeys">
      <ng-container *ngIf="isTestResultArray(testResult[param])">
        <!-- Access the correct parameter key and the associated value -->
        <span *ngIf="getTestResultValue(testResult, param, date)">
            {{ getTestResultValue(testResult, param, date) }}
          </span>
        <!-- If no value exists, show "No Data" -->
        <span *ngIf="!getTestResultValue(testResult, param, date)">
            No Data
          </span>
      </ng-container>
    </td>
  </tr>
  </tbody>
</table>
<button class="btn btn-primary" (click)="goBack()">Back to Patients</button>
